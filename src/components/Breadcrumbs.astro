---
import {
    Breadcrumb,
    BreadcrumbItem,
    BreadcrumbLink,
    BreadcrumbList,
    BreadcrumbPage,
    BreadcrumbSeparator,
} from "@/components/ui/breadcrumb";
import {
    House,
    Library,
    BookOpen,
    User,
    FolderCode,
    type LucideIcon,
} from "lucide-react";

const { pathname } = Astro.url;
const pathSegments = pathname.split("/").filter((segment) => segment !== "");

// Mapping paths to specific icons
const iconMap: Record<string, LucideIcon | undefined> = {
    blog: Library,
    notes: BookOpen,
    about: User,
    projects: FolderCode,
};

const breadcrumbs = pathSegments.map((segment, index) => {
    const href = "/" + pathSegments.slice(0, index + 1).join("/");
    const lowerSegment = segment.toLowerCase();
    const Icon = iconMap[lowerSegment] || null;

    const label =
        segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, " ");
    return { label, href, Icon, isLast: index === pathSegments.length - 1 };
});
---

<Breadcrumb
    className="flex p-2 opacity-60 hover:opacity-100 transition-opacity"
>
    <BreadcrumbList>
        <BreadcrumbItem>
            <BreadcrumbLink href="/">
                <House className="h-4 w-4" />
            </BreadcrumbLink>
        </BreadcrumbItem>

        {breadcrumbs.length > 0 && <BreadcrumbSeparator />}

        {
            breadcrumbs.map((crumb) => (
                <>
                    <BreadcrumbItem>
                        <div class="flex items-center gap-2">
                            {crumb.Icon && <crumb.Icon className="h-4 w-4" />}

                            {crumb.isLast ? (
                                <BreadcrumbPage>{crumb.label}</BreadcrumbPage>
                            ) : (
                                <BreadcrumbLink href={crumb.href}>
                                    {crumb.label}
                                </BreadcrumbLink>
                            )}
                        </div>
                    </BreadcrumbItem>
                    {!crumb.isLast && <BreadcrumbSeparator />}
                </>
            ))
        }
    </BreadcrumbList>
</Breadcrumb>
